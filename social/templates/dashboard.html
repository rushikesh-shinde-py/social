{% extends 'base.html' %}
{% load static %}
{% load mathfilters %}
{% load c_filters %}
{% block content %}
{% if request.user.is_authenticated %}

  <body>

  <section id="container" >
      <!-- **********************************************************************************************************************************************************
      TOP BAR CONTENT & NOTIFICATIONS
      *********************************************************************************************************************************************************** -->
      <!--header start-->
      <header class="header black-bg">
              <div class="sidebar-toggle-box">
                  <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
              </div>
            <!--logo start-->
            <a href="#" class="logo"><b>SOCIAL MODULE</b></a>
            <!--logo end-->
            <div class="nav notify-row" id="top_menu">
                <!--  notification start -->
                <ul class="nav top-menu">
                    <!-- settings start -->
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="fa fa-tasks"></i>
                            <span class="badge bg-theme">4</span>
                        </a>
                        <ul class="dropdown-menu extended tasks-bar">
                            <div class="notify-arrow notify-arrow-green"></div>
                            <li>
                                <p class="green">You have 4 pending tasks</p>
                            </li>
                            <li>
                                <a href="index.html#">
                                    <div class="task-info">
                                        <div class="desc">DashGum Admin Panel</div>
                                        <div class="percent">40%</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 40%">
                                            <span class="sr-only">40% Complete (success)</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="index.html#">
                                    <div class="task-info">
                                        <div class="desc">Database Update</div>
                                        <div class="percent">60%</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%">
                                            <span class="sr-only">60% Complete (warning)</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="index.html#m">
                                    <div class="task-info">
                                        <div class="desc">Product Development</div>
                                        <div class="percent">80%</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 80%">
                                            <span class="sr-only">80% Complete</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="index.html#">
                                    <div class="task-info">
                                        <div class="desc">Payments Sent</div>
                                        <div class="percent">70%</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" style="width: 70%">
                                            <span class="sr-only">70% Complete (Important)</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li class="external">
                                <a href="#">See All Tasks</a>
                            </li>
                        </ul>
                    </li>
                    <!-- settings end -->
                    <!-- inbox dropdown start-->
                    <li id="header_inbox_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="index.html#">
                            <i class="fa fa-envelope-o"></i>
                            <span class="badge bg-theme">5</span>
                        </a>
                        <ul class="dropdown-menu extended inbox">
                            <div class="notify-arrow notify-arrow-green"></div>
                            <li>
                                <p class="green">You have 5 new messages</p>
                            </li>
                            <li>
                                <a href="index.html#">
                                    <span class="photo"><img alt="avatar" src="assets/img/ui-zac.jpg"></span>
                                    <span class="subject">
                                    <span class="from">Zac Snider</span>
                                    <span class="time">Just now</span>
                                    </span>
                                    <span class="message">
                                        Hi mate, how is everything?
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="index.html#">
                                    <span class="photo"><img alt="avatar" src="assets/img/ui-divya.jpg"></span>
                                    <span class="subject">
                                    <span class="from">Divya Manian</span>
                                    <span class="time">40 mins.</span>
                                    </span>
                                    <span class="message">
                                     Hi, I need your help with this.
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="index.html#">
                                    <span class="photo"><img alt="avatar" src="assets/img/ui-danro.jpg"></span>
                                    <span class="subject">
                                    <span class="from">Dan Rogers</span>
                                    <span class="time">2 hrs.</span>
                                    </span>
                                    <span class="message">
                                        Love your new Dashboard.
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="index.html#">
                                    <span class="photo"><img alt="avatar" src="assets/img/ui-sherman.jpg"></span>
                                    <span class="subject">
                                    <span class="from">Dj Sherman</span>
                                    <span class="time">4 hrs.</span>
                                    </span>
                                    <span class="message">
                                        Please, answer asap.
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="index.html#">See all messages</a>
                            </li>
                        </ul>
                    </li>
                    <!-- inbox dropdown end -->
                </ul>
                <!--  notification end -->
            </div>
            <div class="top-menu">
            	<ul class="nav pull-right top-menu">
                    <li><a class="logout" href="{% url 'social:logout' %}">Logout</a></li>
            	</ul>
            </div>
        </header>
      <!--header end-->
      
      <!-- **********************************************************************************************************************************************************
      MAIN SIDEBAR MENU
      *********************************************************************************************************************************************************** -->
      <!--sidebar start-->
      <aside>
          <div id="sidebar"  class="nav-collapse ">
              <!-- sidebar menu start-->
              <ul class="sidebar-menu" id="nav-accordion">

              	  <p class="centered"><a href="profile.html"><img src="{% static 'img/ui-sam.jpg' %}" class="img-circle" width="60"></a></p>
              	  <h5 class="centered">{{ user.first_name | title }} {{ user.last_name | title }}</h5>
              	  	
                  <li class="mt">
                      <a class="active" href="{% url 'social:profile' %}">
                          <i class="fa fa-dashboard"></i>
                          <span>Profile</span>
                      </a>
                  </li>

                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class="fa fa-desktop"></i>
                          <span>UI Elements</span>
                      </a>
                      <ul class="sub">
                          <li><a  href="general.html">General</a></li>
                          <li><a  href="buttons.html">Buttons</a></li>
                          <li><a  href="panels.html">Panels</a></li>
                      </ul>
                  </li>

                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class="fa fa-cogs"></i>
                          <span>Components</span>
                      </a>
                      <ul class="sub">
                          <li><a  href="calendar.html">Calendar</a></li>
                          <li><a  href="gallery.html">Gallery</a></li>
                          <li><a  href="todo_list.html">Todo List</a></li>
                      </ul>
                  </li>
                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class="fa fa-book"></i>
                          <span>Extra Pages</span>
                      </a>
                      <ul class="sub">
                          <li><a  href="blank.html">Blank Page</a></li>
                          <li><a  href="login.html">Login</a></li>
                          <li><a  href="lock_screen.html">Lock Screen</a></li>
                      </ul>
                  </li>
                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class="fa fa-tasks"></i>
                          <span>Forms</span>
                      </a>
                      <ul class="sub">
                          <li><a  href="form_component.html">Form Components</a></li>
                      </ul>
                  </li>
                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class="fa fa-th"></i>
                          <span>Data Tables</span>
                      </a>
                      <ul class="sub">
                          <li><a  href="basic_table.html">Basic Table</a></li>
                          <li><a  href="responsive_table.html">Responsive Table</a></li>
                      </ul>
                  </li>
                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class=" fa fa-bar-chart-o"></i>
                          <span>Charts</span>
                      </a>
                      <ul class="sub">
                          <li><a  href="morris.html">Morris</a></li>
                          <li><a  href="chartjs.html">Chartjs</a></li>
                      </ul>
                  </li>

              </ul>
              <!-- sidebar menu end-->
          </div>
      </aside>
      <!--sidebar end-->
      
      <!-- **********************************************************************************************************************************************************
      MAIN CONTENT
      *********************************************************************************************************************************************************** -->
      <!--main content start-->
      <section id="main-content">
          <section class="wrapper">

              <div class="row">
                  <div class="col-lg-9 main-chart">
                      <div>

                       <form class="post-create-form" method="post" action="{% url 'social:post-create' %}">
                           {% csrf_token %}
                           <div class="form-group">
                               <p><input type="text" name="post-title" class="form-control" placeholder="Post Title"></p>
                               <p><textarea style="resize:none;" name="post-content" class="form-control" rows="3" placeholder="What's on your mind!"></textarea></p>
                               <p><button class="btn btn-sm btn-primary" type="submit" style="margin-top:10px;">POST</button></p>
                           </div>
                       </form>
                  	<!--<div class="row mtbox">-->
                  		<!--<div class="col-md-2 col-sm-2 col-md-offset-1 box0">-->
                  			<!--<div class="box1">-->
					  			<!--<span class="li_heart"></span>-->
					  			<!--<h3>933</h3>-->
                  			<!--</div>-->
					  			<!--<p>933 People liked your page the last 24hs. Whoohoo!</p>-->
                  		<!--</div>-->
                  		<!--<div class="col-md-2 col-sm-2 box0">-->
                  			<!--<div class="box1">-->
					  			<!--<span class="li_cloud"></span>-->
					  			<!--<h3>+48</h3>-->
                  			<!--</div>-->
					  			<!--<p>48 New files were added in your cloud storage.</p>-->
                  		<!--</div>-->
                  		<!--<div class="col-md-2 col-sm-2 box0">-->
                  			<!--<div class="box1">-->
					  			<!--<span class="li_stack"></span>-->
					  			<!--<h3>23</h3>-->
                  			<!--</div>-->
					  			<!--<p>You have 23 unread messages in your inbox.</p>-->
                  		<!--</div>-->
                  		<!--<div class="col-md-2 col-sm-2 box0">-->
                  			<!--<div class="box1">-->
					  			<!--<span class="li_news"></span>-->
					  			<!--<h3>+10</h3>-->
                  			<!--</div>-->
					  			<!--<p>More than 10 news were added in your reader.</p>-->
                  		<!--</div>-->
                  		<!--<div class="col-md-2 col-sm-2 box0">-->
                  			<!--<div class="box1">-->
					  			<!--<span class="li_data"></span>-->
					  			<!--<h3>OK!</h3>-->
                  			<!--</div>-->
					  			<!--<p>Your server is working perfectly. Relax & enjoy.</p>-->
                  		<!--</div>-->

                      </div><!-- /row mt --><hr/>
                  
                     <div class="row">
						<!-- TWITTER PANEL -->
                         {% for post in posts %}
                       <div class="col-md-12 col-sm-12 mb" id="post-id-{{ post.id }}">
						<div class="panel panel-info ">
                            <input type="hidden" name="id" value="{{ post.id }}">
                            <div class="panel-heading"><a href="#" onclick="show_post({{ post.id }})" data-toggle="modal" data-target="#post_view_modal"><span id="post-title">{{ post.title | title }}</span></a>
                                {% if user.first_name == post.author.first_name and user.last_name == post.author.last_name %}
                                <div  style="float:right">
                                    <i onclick="update_post({{ post.id }})" data-toggle="modal" data-target="#updateModal" style="transform:scale(1.3,1.3);margin:0px 8px;cursor:pointer" class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                    <i onclick="delete_post({{ post.id }})" style="transform:scale(1.3,1.3);cursor:pointer" class="glyphicon glyphicon-remove"></i>
                                </div>
                                {% endif %}
                            </div>
                      		<div class="panel-body">
                               <div class="row">
                                   <div class="col-md-12">
                                       <div style="float:right;">
                                           <strong id="post-author">
                                               {{ post.author.first_name | title }} {{ post.author.last_name | title }}</strong> :
                                           <span id="post-published">
                                               <small>{{ post.published_date|timesince }} ago</small>
                                           </span>
                                       </div>
                                   </div>
                               </div>
                                    <hr style="border-top: 1px solid #797979;margin-top:10px;margin-bottom:10px;">
                                    <p id="post-text">
                                        {% if post.text|count_length > 500 %}
                                            {{ post.text |title|show_more }}
                                            <i data-toggle="modal" data-target="#post_view_modal" onclick="show_post({{ post.id }})" style="transform:scale(1,1);cursor:pointer" class="glyphicon glyphicon-new-window"></i>
                                        {% else %}
                                            {{ post.text|title }}
                                        {% endif %}
                                    </p>
                            </div>
                            <div class="panel-heading">
                                <ul class="dlikes list-group" >
                                    {% get_like_obj post.id request.user.id as obj %}
                                    {% if obj %}
                                    <li class="list-group-item">
                                        <i onclick="undolike({{ post.id }})" style="transform:scale(1.5,1.5); cursor:pointer;" class="undolike likedislikeclass glyphicon glyphicon-thumbs-up" aria-hidden="true"></i>
                                    </li>
                                    {% else %}
                                        <li class="list-group-item">
                                            <i onclick="like({{ post.id }})" style="transform:scale(1.5,1.5);cursor:pointer;" class="like glyphicon glyphicon-thumbs-up" aria-hidden="true"></i>
                                        </li>
                                    {%endif%}    

                                    <li class="list-group-item">
                                        <strong id="like-count">{{ post.likes.count }}</strong>
                                    </li>

                                    {% get_dislike_obj post.id request.user.id as obj %}
                                    {% if obj %}
                                    <li class="list-group-item">
                                        <i onclick="undodislike({{ post.id }})" style="transform:scale(1.5,1.5); cursor:pointer;" class="undodislike likedislikeclass glyphicon glyphicon-thumbs-down" aria-hidden="true"></i>
                                    </li>
                                    {% else %}
                                        <li class="list-group-item">
                                            <i onclick="dislike({{ post.id }})" style="transform:scale(1.5,1.5);cursor:pointer;" class="dislike glyphicon glyphicon-thumbs-down" aria-hidden="true"></i>
                                        </li>
                                    {%endif%}    

                                    {% if post.dislikes.count > 0 %}    
                                        <li class="list-group-item">
                                            <strong id="dislike-count">{{ post.dislikes.count }}</strong>
                                        </li>
                                    {% else %}
                                        <li class="list-group-item">
                                            <strong id="dislike-count"></strong>
                                        </li>
                                    {% endif %}    

                                    <li class="list-group-item">
                                        <i onclick="comment({{ post.id }})" style="transform:scale(1.5,1.5); cursor:pointer;" class="glyphicon glyphicon-comment" aria-hidden="true"></i>
                                    </li>
                                    <li class="list-group-item">
                                        <strong id="comment-count">{{ post.comment_set.count }}</strong>
                                    </li>
                                </ul>
                                <div class="write-comment" style="display: none;">
                                    <form id="comment-form-{{ post.id }}" method="post">
                                        {% csrf_token %}
                                        <input type="hidden" name="post-id" value="{{ post.id }}">
                                        <textarea maxlength="160" style="margin: 10px 0px; border: none;" class="comment-box form-control" placeholder="Comment here..."></textarea>
                                        <input type="button" name="close-comment" class="btn" value="Cancel">
                                        <input type="submit" disabled name="comment" style="display:none;" class="btn btn-primary" value="Comment">
                                    </form>
                                    <div class="comments-replies">
                                        {% get_comments post.comment_set.all as qs %}
                                        {% if qs%}
                                        <h5>Comments</h5>
                                        {% endif %}
                                        <div class="comment-wrapper">
                                            {% for each_comment in qs %}
                                            <div style="margin:10px 10px;"><strong class="commenter">{{ each_comment.user.first_name|title }} {{ each_comment.user.last_name|title }}</strong> commented <span class="comment-timestamp">
                                            {% if each_comment.commented_at|timesince == '0 minutes' %}
                                            <small> just now </small>
                                            {% else %}
                                                <small> {{ each_comment.commented_at|timesince }} ago</small>
                                            {% endif %}
                                            </div>
                                            <ul class="list-group comment-div" id="comment-id-{{each_comment.id}}">
                                                <li class="list-group-item" style="display:inline-block;">
                                                    {{ each_comment.message|title }}
                                                    <input type="button" style="margin-bottom:0px; background-color:#fff; color: #2b6eff; border:none; padding:0px;" class="" onclick="reply_to_comment({{each_comment.id}}, {{post.id}})" name="reply-button" value="Reply">
                                                </li>
                                                <form style="display:none; padding-left:15px; padding-right:15px;" name="reply-to-comment" method="post">
                                                    {% csrf_token %}
                                                    <textarea style="margin:10px 0px;" class="form-control" placeholder="Reply here..." name="reply-area"></textarea>
                                                    {% comment %} <br> {% endcomment %}
                                                    <input class="btn btn-primary" style="display:none" type="submit" disabled name="reply" value="Reply">
                                                </form>
                                                <br>
                                                    {% get_replies each_comment.parent.all as reply_queryset %}
                                                    {%if reply_queryset %}
                                                    <button style="background-color:transparent; color: #2b6eff; border:none; margin-left: 10px;" name="show-replies">show replies</button>

                                                        <h5 id="reply-count" style="padding:15px;">{{ reply_queryset.count|pluralize_reply }}</h5>
                                                        <div class="replies">
                                                            {% for each_reply in reply_queryset %}
                                                                <div class="reply-wrapper">
                                                                    <ul  style="display:none;margin-left:50px" class="list-group reply-div">
                                                                        <div style="margin:10px 0px;"><strong class="replier">{{ each_reply.user.first_name|title }} {{ each_reply.user.last_name|title }}</strong> replied <span class="reply-timestamp"><small>{{ each_reply.commented_at|timesince }}</span> ago</small><br></div>
                                                                        <li class="list-group-item" style="display:inline-block;">{{ each_reply.reply|title }}</li>
                                                                    </ul>
                                                                </div>
                                                            {% endfor %}
                                                        </div>
                                                    {% endif %}
                                            </ul>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                       </div>
                     </div>
                         {% endfor %}
                     </div>
				{% comment %} <div class="row mt">
                      <!--CUSTOM CHART START -->
                      <div class="border-head">
                          <h3>VISITS</h3>
                      </div>
                      <div class="custom-bar-chart">
                          <ul class="y-axis">
                              <li><span>10.000</span></li>
                              <li><span>8.000</span></li>
                              <li><span>6.000</span></li>
                              <li><span>4.000</span></li>
                              <li><span>2.000</span></li>
                              <li><span>0</span></li>
                          </ul>
                          <div class="bar">
                              <div class="title">JAN</div>
                              <div class="value tooltips" data-original-title="8.500" data-toggle="tooltip" data-placement="top">85%</div>
                          </div>
                          <div class="bar ">
                              <div class="title">FEB</div>
                              <div class="value tooltips" data-original-title="5.000" data-toggle="tooltip" data-placement="top">50%</div>
                          </div>
                          <div class="bar ">
                              <div class="title">MAR</div>
                              <div class="value tooltips" data-original-title="6.000" data-toggle="tooltip" data-placement="top">60%</div>
                          </div>
                          <div class="bar ">
                              <div class="title">APR</div>
                              <div class="value tooltips" data-original-title="4.500" data-toggle="tooltip" data-placement="top">45%</div>
                          </div>
                          <div class="bar">
                              <div class="title">MAY</div>
                              <div class="value tooltips" data-original-title="3.200" data-toggle="tooltip" data-placement="top">32%</div>
                          </div>
                          <div class="bar ">
                              <div class="title">JUN</div>
                              <div class="value tooltips" data-original-title="6.200" data-toggle="tooltip" data-placement="top">62%</div>
                          </div>
                          <div class="bar">
                              <div class="title">JUL</div>
                              <div class="value tooltips" data-original-title="7.500" data-toggle="tooltip" data-placement="top">75%</div>
                          </div>
                      </div>
                      <!--custom chart end-->
					</div><!-- /row -->	 {% endcomment %}
					
                  </div><!-- /col-lg-9 END SECTION MIDDLE -->
                  
                  
      <!-- **********************************************************************************************************************************************************
      RIGHT SIDEBAR CONTENT
      *********************************************************************************************************************************************************** -->                  
                  
                  <div class="col-lg-3 ds">
                    <!--COMPLETED ACTIONS DONUTS CHART-->
						<h3>NOTIFICATIONS</h3>
                                        
                      <!-- First Action -->
                      <div class="desc">
                      	<div class="thumb">
                      		<span class="badge bg-theme"><i class="fa fa-clock-o"></i></span>
                      	</div>
                      	<div class="details">
                      		<p><muted>2 Minutes Ago</muted><br/>
                      		   <a href="#">James Brown</a> subscribed to your newsletter.<br/>
                      		</p>
                      	</div>
                      </div>
                      <!-- Second Action -->
                      <div class="desc">
                      	<div class="thumb">
                      		<span class="badge bg-theme"><i class="fa fa-clock-o"></i></span>
                      	</div>
                      	<div class="details">
                      		<p><muted>3 Hours Ago</muted><br/>
                      		   <a href="#">Diana Kennedy</a> purchased a year subscription.<br/>
                      		</p>
                      	</div>
                      </div>
                      <!-- Third Action -->
                      <div class="desc">
                      	<div class="thumb">
                      		<span class="badge bg-theme"><i class="fa fa-clock-o"></i></span>
                      	</div>
                      	<div class="details">
                      		<p><muted>7 Hours Ago</muted><br/>
                      		   <a href="#">Brandon Page</a> purchased a year subscription.<br/>
                      		</p>
                      	</div>
                      </div>
                      <!-- Fourth Action -->
                      <div class="desc">
                      	<div class="thumb">
                      		<span class="badge bg-theme"><i class="fa fa-clock-o"></i></span>
                      	</div>
                      	<div class="details">
                      		<p><muted>11 Hours Ago</muted><br/>
                      		   <a href="#">Mark Twain</a> commented your post.<br/>
                      		</p>
                      	</div>
                      </div>
                      <!-- Fifth Action -->
                      <div class="desc">
                      	<div class="thumb">
                      		<span class="badge bg-theme"><i class="fa fa-clock-o"></i></span>
                      	</div>
                      	<div class="details">
                      		<p><muted>18 Hours Ago</muted><br/>
                      		   <a href="#">Daniel Pratt</a> purchased a wallet in your store.<br/>
                      		</p>
                      	</div>
                      </div>

                       <!-- USERS ONLINE SECTION -->
						<h3>TEAM MEMBERS</h3>
                      <!-- First Member -->
                      <div class="desc">
                      	<div class="thumb">
                      		<img class="img-circle" src="assets/img/ui-divya.jpg" width="35px" height="35px" align="">
                      	</div>
                      	<div class="details">
                      		<p><a href="#">DIVYA MANIAN</a><br/>
                      		   <muted>Available</muted>
                      		</p>
                      	</div>
                      </div>
                      <!-- Second Member -->
                      <div class="desc">
                      	<div class="thumb">
                      		<img class="img-circle" src="assets/img/ui-sherman.jpg" width="35px" height="35px" align="">
                      	</div>
                      	<div class="details">
                      		<p><a href="#">DJ SHERMAN</a><br/>
                      		   <muted>I am Busy</muted>
                      		</p>
                      	</div>
                      </div>
                      <!-- Third Member -->
                      <div class="desc">
                      	<div class="thumb">
                      		<img class="img-circle" src="assets/img/ui-danro.jpg" width="35px" height="35px" align="">
                      	</div>
                      	<div class="details">
                      		<p><a href="#">DAN ROGERS</a><br/>
                      		   <muted>Available</muted>
                      		</p>
                      	</div>
                      </div>
                      <!-- Fourth Member -->
                      <div class="desc">
                      	<div class="thumb">
                      		<img class="img-circle" src="assets/img/ui-zac.jpg" width="35px" height="35px" align="">
                      	</div>
                      	<div class="details">
                      		<p><a href="#">Zac Sniders</a><br/>
                      		   <muted>Available</muted>
                      		</p>
                      	</div>
                      </div>
                      <!-- Fifth Member -->
                      <div class="desc">
                      	<div class="thumb">
                      		<img class="img-circle" src="assets/img/ui-sam.jpg" width="35px" height="35px" align="">
                      	</div>
                      	<div class="details">
                      		<p><a href="#">Marcel Newman</a><br/>
                      		   <muted>Available</muted>
                      		</p>
                      	</div>
                      </div>

                        <!-- CALENDAR-->
                        <div id="calendar" class="mb">
                            <div class="panel green-panel no-margin">
                                <div class="panel-body">
                                    <div id="date-popover" class="popover top" style="cursor: pointer; disadding: block; margin-left: 33%; margin-top: -50px; width: 175px;">
                                        <div class="arrow"></div>
                                        <h3 class="popover-title" style="disadding: none;"></h3>
                                        <div id="date-popover-content" class="popover-content"></div>
                                    </div>
                                    <div id="my-calendar"></div>
                                </div>
                            </div>
                        </div><!-- / calendar -->
                      
                  </div><!-- /col-lg-3 -->
              </div><! --/row -->
          </section>
      </section>

      <!--main content end-->
      <!--footer start-->
      <footer class="site-footer">
          <div class="text-center">
              2014 - Alvarez.is
              <a href="index.html#" class="go-top">
                  <i class="fa fa-angle-up"></i>
              </a>
          </div>
      </footer>
      <!--footer end-->
  </section>


  <!--modals-->

  <!--delete prompt modal-->
      <div class="modal fade" id="deletepromptmodal" tabindex="-1" role="dialog" aria-labelledby="deletepromptmodalLabel">
        <div class="modal-dialog" role="document">
          <div class="modal-content" style="border: solid 1px red; border-top-left-radius: 0px; border-top-right-radius: 0px;">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
              <h4 class="modal-title" id="deletepromptmodalLabel">Do you really want to DELETE?</h4>
            </div>
            <div class="modal-body">
                <p id="delete_title"></p>
            <div class="modal-footer">
                <button type="button" id="delete_confirm" class="btn btn-danger" >DELETE</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
            </div>
          </div>
        </div>
      </div>

  <!--deletion message modal-->
    <div class="modal fade" id="delete_message" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
              <button type="button" style="float:right;" class="close" data-dismiss="modal" aria-label="Close">
               <i style="top:-5px" aria-hidden="true" style="padding-right:10px; float:right; cursor:pointer;" class="glyphicon glyphicon-remove"></i>
              </button>
          </div>
          <div class="modal-body">
            <p class="text-center">Post has been <span class="text-danger">DELETED</span> successfully!</p>
          </div>
        </div>
      </div>
    </div>


    <!--updation message modal-->
    <div class="modal fade" id="update_message" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
              <button type="button" style="float:right;" class="close" data-dismiss="modal" aria-label="Close">
               <i style="top:-5px" aria-hidden="true" style="padding-right:10px; float:right; cursor:pointer;" class="glyphicon glyphicon-remove"></i>
              </button>
          </div>
          <div class="modal-body">
            <p class="text-center">Post has been <span class="text-info">UPDATED</span> successfully!</p>
          </div>
        </div>
      </div>
    </div>


  <!--view post modal-->
    <div class="modal fade" id="post_view_modal" tabindex="-1" role="dialog" aria-labelledby="post_view_modalLongTitle" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
              <div class="row">
                  <div class="col-md-12">
                    <h5 style="float:left;" class="modal-title" id="post_view_modalLongTitle"></h5>
                  </div>
                  <!--<div class="col-md-1">-->
                    <button type="button" style="float:right;" class="close" data-dismiss="modal" aria-label="Close">
                      <i aria-hidden="true" style="padding-right:10px; float:right; cursor:pointer;" class="glyphicon glyphicon-remove"></i>
                    </button>
                  <!--</div>-->
              </div>
          </div>
          <div class="modal-body">
            <div class="row">
               <div class="col-md-12">
                   <div style="border-bottom:1px solid #666;padding-bottom:5px;">
                       POSTED BY  <strong id="post-view-author" style="font-size:16px;"></strong>
                        <small id="post-view-published"></small>
                   </div>
                <div  id="post-view-text" style="margin:10px 0px;"></div>
               </div>
           </div>

          </div>
         <!-- <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>-->
        </div>
      </div>
    </div>


  <!--update modal-->
  <div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="updateModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
          <h4 class="modal-title" id="updateModalLabel">Post details</h4>
        </div>
        <div class="modal-body">
          <form class="post-update-form" method="post">
               {% csrf_token %}
               <div class="form-group">
                   <p><input type="text" id="update-post-title" class="form-control" placeholder="Post Title"></p>
                   <p><textarea style="resize:none;" id="update-post-content" class="form-control" rows="3" placeholder="What's on your mind!"></textarea></p>
               </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary" >Save changes</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
        </form>
        </div>
      </div>
    </div>
  </div>


    <!-- js placed at the end of the document so the pages load faster -->
    <script src="{% static 'js/jquery.js' %}"></script>
    <script src="{% static 'js/jquery-1.8.3.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script class="include" type="text/javascript" src="{% static 'js/jquery.dcjqaccordion.2.7.js' %}"></script>
    <script src="{% static 'js/jquery.scrollTo.min.js' %}"></script>
    <script src="{% static 'js/jquery.nicescroll.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/jquery.sparkline.js' %}"></script>


    <!--common script for all pages-->
    <script src="{% static 'js/common-scripts.js' %}"></script>
    
    <script type="text/javascript" src="{% static 'js/gritter/js/jquery.gritter.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/gritter-conf.js' %}"></script>

    <!--script for this page-->
    <script src="{% static 'js/sparkline-chart.js' %}"></script>
	<script src="{% static 'js/zabuto_calendar.js' %}"></script>
	
	<!--<script type="text/javascript">
        $(document).ready(function () {
        var unique_id = $.gritter.add({
            // (string | mandatory) the heading of the notification
            title: 'Welcome to Dashgum!',
            // (string | mandatory) the text inside the notification
            text: 'Hover me to enable the Close Button. You can hide the left sidebar clicking on the button next to the logo. Free version for <a href="http://blacktie.co" target="_blank" style="color:#ffd777">BlackTie.co</a>.',
            // (string | optional) the image to display on the left
            image: 'assets/img/ui-sam.jpg',
            // (bool | optional) if you want it to fade out on its own or just sit there
            sticky: true,
            // (int | optional) the time you want it to be alive for before fading out
            time: '',
            // (string | optional) the class name you want to apply to that specific message
            class_name: 'my-sticky-class'
        });

        return false;
        });
	</script>-->
	
	<script type="application/javascript">

        $(document).ready(function () {
            $("#date-popover").popover({html: true, trigger: "manual"});
            $("#date-popover").hide();
            $("#date-popover").click(function (e) {
                $(this).hide();
            });

            $("#my-calendar").zabuto_calendar({
                action: function () {
                    return myDateFunction(this.id, false);
                },
                action_nav: function () {
                    return myNavFunction(this.id);
                },
                ajax: {
                    url: "show_data.php?action=1",
                    modal: true
                },
                legend: [
                    {type: "text", label: "Special event", badge: "00"},
                    {type: "block", label: "Regular event", }
                ]
            });
        });

        
        function myNavFunction(id) {
            $("#date-popover").hide();
            var nav = $("#" + id).data("navigation");
            var to = $("#" + id).data("to");
            console.log('nav ' + nav + ' to: ' + to.month + '/' + to.year);
        }

     $('button[name="show-replies"]').click(function(){
        if ($(this).text().trim() == 'Hide replies'){
           $('.reply-div').hide();
           $(this).text('show-replies');

        }else{
            $('.reply-div').hide();
            $(this).parent().find('.reply-div').fadeToggle();
            $(this).text('Hide replies');
        }

     });

    // replying comments
    function add_reply_to_page(comment_id, post_id, data){
        console.log(data);
        console.log(data.reply_message);
        $("#comment-id-" + comment_id).append(`
            <div class="reply-wrapper">
                <ul  style="display:none;margin-left:50px" class="list-group reply-div">
                    <div style="margin:10px 0px;"><strong class="replier">${data.reply_user_fname} ${data.reply_user_lname}</strong> replied <span class="reply-timestamp"><small>just now</small></span><br></div>
                    <li class="list-group-item" style="display:inline-block;">${data.reply_message}</li>
                </ul>
            </div>
        `)
        $('.reply-div').show();
        $("#comment-id-" + comment_id).find("#reply-count").text(data.total_replies);
        $('button[name="show-replies"]').text('Hide replies');
        {% comment %} $(".comment-div").fadeIn(); {% endcomment %}
        $(".comments-replies").fadeIn();
        $("#comment-id-" + comment_id).find("#hidden-reply-count").fadeIn().text(data.total_replies);
        

    }

    function reply_to_comment(comment_id, post_id){
        $('#comment-id-' + comment_id).find('input[name="reply-button"]').fadeOut();
        console.log("reply")
        $('form[name="reply-to-comment"]').fadeOut();
        $("#comment-id-" + comment_id).find('textarea[name="reply-area"]').parent().fadeIn();
            $('textarea[name="reply-area"]').keyup(function(){
                var char_len = $(this).val().trim().length;
                if (char_len > 0){
                    $(this).parent().find('input[type="submit"]').attr('disabled', false).fadeIn().css('margin-bottom', '10px');
                }else if(char_len == 0){
                    $(this).parent().find('input[type="submit"]').attr('disabled', true).fadeOut();
                }
            });
            $('form[name="reply-to-comment"]').submit(function(event){
                event.preventdefault;
                var reply = $(this).find('textarea[name="reply-area"]').val().trim();
                console.log(reply);
                $.ajax({
                    url: "{% url 'social:reply-to-comment' %}",
                    type: "POST",
                    data: {
                        'csrfmiddlewaretoken': '{{ csrf_token }}',
                        'comment_id': comment_id,
                        'reply': reply,
                    },
                    success: function(data){
                        console.log(data.result);
                        add_reply_to_page(comment_id, post_id, data);
                    },
                    error: function(data){
                    },
                    complete: function(data){
                    }
                });
                $('form[name="reply-to-comment"]').trigger("reset");
                return false;
            });
            return false;
    }


    // commenting post
    function add_comment_to_page(id, data){
        console.log(data);
        console.log(data.comment_message);
        $("#post-id-" + id).find("#comment-count").text(data.total_comments);
        $("#post-id-" + id).find(".comment-wrapper").prepend(`
            <div style="margin:10px 10px;"><strong class="commenter">${data.comment_user_fname} ${data.comment_user_lname}</strong> commented <span class="comment-timestamp"> just now</span></div>
            <ul class="list-group comment-div" id="comment-id-${data.comment_id}">
                <li class="list-group-item" style="display:inline-block;">
                    ${data.comment_message}
                    <input type="button" style="margin-bottom:0px; background-color:#fff; color: #2b6eff; border:none; padding:0px;" class="" onclick="reply_to_comment(${data.comment_id}, ${id})" name="reply-button" value="Reply">
                </li>
                <form style="display:none; padding-left:15px; padding-right:15px;" name="reply-to-comment" method="post">
                    {% csrf_token %}
                    <textarea style="margin:10px 0px;" class="form-control" placeholder="Reply here..." name="reply-area"></textarea>
                    {% comment %} <br> {% endcomment %}
                    <input class="btn btn-primary" type="submit" style="display:none" disabled name="reply" value="Reply">
                </form>
                {% comment %} <br> {% endcomment %}
                    {% comment %} {% get_replies each_comment.parent.all as reply_queryset %}
                    {%if reply_queryset %}
                    <button style="background-color:transparent; color: #2b6eff; border:none; margin-left: 10px;" name="show-replies">show replies</button>

                        <h5 style="padding:15px;">{{ reply_queryset.count|pluralize_reply }}</h5>
                        {% for each_reply in reply_queryset %}
                            <ul  style="display:none;margin-left:50px" class="list-group reply-div">
                                <div style="margin:10px 0px;"><strong class="replier">{{ each_reply.user.first_name|title }} {{ each_reply.user.last_name|title }}</strong> replied <span class="reply-timestamp">{{ each_reply.commented_at|timesince }}</span> ago<br></div>
                                <li class="list-group-item" style="display:inline-block;">{{ each_reply.reply|title }}</li>
                            </ul>
                        {% endfor %}
                    {% endif %} {% endcomment %}
            </ul>
        `)
    }

    function comment(id){
        $(".write-comment").fadeOut();
        $("#post-id-" + id).find(".write-comment").fadeToggle();
        $(".write-comment").find('.comment-box').keyup(function(){
            var char_len = $(this).val().trim().length;
            if (char_len > 0){
                $(".write-comment").find('input[type="submit"]').attr('disabled', false).fadeIn();
            }else if(char_len == 0){
                $(".write-comment").find('input[type="submit"]').attr('disabled', true).fadeOut();
            }
        });
        $("#comment-form-" + id).submit(function(event){
            event.preventdefault;
            var post_id = $("#comment-form-" + id).find('input[name="post-id"]').val().trim();
            var post_comment = $("#comment-form-" + id).find('.comment-box').val().trim();
            console.log(post_id, post_comment)
            $.ajax({
                    url: "{% url 'social:comment' %}",
                    type: "POST",
                    data: {
                        'csrfmiddlewaretoken': '{{ csrf_token }}',
                        'post_id': post_id,
                        'comment': post_comment,
                    },
                    success: function(data){
                        add_comment_to_page(id, data);
                    },
                    error: function(data){
                    },
                    complete: function(data){
                    }
        });

        $("#comment-form-" + id).trigger("reset");
        return false;
    });
    return false;
    }


    // post deletion
    function delete_post(id){
        var title = $("#post-id-" + id).find("#post-title").text();
        $("#deletepromptmodal").modal("show");
        $("#deletepromptmodal").find("#delete_title").text(title);
        $("#delete_confirm").click(function(){
            $.ajax({
                url: "{% url 'social:ajax_requests' %}",
                type: "POST",
                data: {
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                    'id': id,
                    'request_type': 'delete',
                },
                success: function(data){
                    console.log(data)
                    if (data.deleted){
                        $("#post-id-" + id).remove();
                    }
                },
                error: function(data){
                    console.log(data)
                }
            });
            $("#deletepromptmodal").modal("hide");
            $("#delete_message").modal("show");
        });

    }

    // post updation
    function update_to_page(id, data){
      $("#post-id-" + id).find("#post-title").text(data.title);
      $("#post-id-" + id).find("#post-text").text(data.text);
      $("#post-id-" + id).find("#post-published").text(data.published_date);
    }

    function update_post(id){
        var title = $("#post-id-" + id).find("#post-title").text().trim();
        var content = $("#post-id-" + id).find("#post-text").text().trim();
        $(".post-update-form").find("#update-post-title").val(title);
        $(".post-update-form").find("#update-post-content").val(content);

         $(".post-update-form").submit(function(event){
            event.preventDefault();
            var title = $(".post-update-form").find("#update-post-title").val().trim();
            var content = $(".post-update-form").find("#update-post-content").val().trim();
            $.ajax({
                url: "{% url 'social:ajax_requests' %}",
                type: "POST",
                data: {
                    'id': id,
                    'title': title,
                    'content': content,
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                    'request_type': 'update',
                },
                success: function(data){
                    <!--console.log(data)-->
                    if (data.updated){
                        console.log(data)
                        update_to_page(id, data);
                    }
                },
                error: function(data){
                    console.log(data)
                }
            });
            $('.post-update-form').trigger("reset");
            $('#updateModal').modal('hide');
            $('.modal-backdrop').remove();
            $("#update_message").modal("show");
            return false;
         });
       }



    // post-view modal
    function show_post(id){
        var title = $("#post-id-" + id).find("#post-title").text().trim();
        var author = $("#post-id-" + id).find("#post-author").text().trim();
        var published = $("#post-id-" + id).find("#post-published").text().trim();
        $.ajax({
            url: "{% url 'social:show-post-details' %}",
            data: {
                'post_id': id
            },
            type: "GET",
            success: function(data){
                console.log(data.content)
                $("#post-view-text").text(data.content);
                $("#post_view_modalLongTitle").text(title);
                $("#post-view-author").text(author);
                $("#post-view-published").text(published);
            }

        });
        
        $('#post_view_modal').modal('hide');
        $('.modal-backdrop').remove();
        return false;
       }

    // like posts
    function like(id){
    $("#post-id-" + id).find(".like").addClass("likedislikeclass");
        $.ajax({
                url: "{% url 'social:likedislike-requests' %}",
                type: "POST",
                data: {
                    'post_id': id,
                    'action': 'like',
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                success: function(data){
                    $("#post-id-" + id).find("#like-count").text(data.counts);
                },
                error: function(data){
                    console.log(data);
                }
            });
    $("#post-id-" + id).find(".like").attr("onclick", "undolike(" + id + ")");
    $("#post-id-" + id).find(".like").removeClass("like").addClass("undolike");
    }

    // undolike posts
    function undolike(id){
    $("#post-id-" + id).find(".undolike").removeClass("likedislikeclass");

        $.ajax({
                url: "{% url 'social:likedislike-requests' %}",
                type: "POST",
                data: {
                    'post_id': id,
                    'action': 'dislike',
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                success: function(data){
                    $("#post-id-" + id).find("#like-count").text(data.counts);
                },
                error: function(data){
                    console.log(data);
                }
            });
    $("#post-id-" + id).find(".undolike").attr("onclick", "like(" + id + ")");
    $("#post-id-" + id).find(".undolike").removeClass("undolike").addClass("like");
    }

    // dislike posts
    function dislike(id){
    $("#post-id-" + id).find(".dislike").addClass("likedislikeclass");
        $.ajax({
                url: "{% url 'social:dislike-requests' %}",
                type: "POST",
                data: {
                    'post_id': id,
                    'action': 'like',
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                success: function(data){
                    $("#post-id-" + id).find("#dislike-count").text(data.counts);
                },
                error: function(data){
                    console.log(data);
                }
            });
    $("#post-id-" + id).find(".dislike").attr("onclick", "undodislike(" + id + ")");
    $("#post-id-" + id).find(".dislike").removeClass("dislike").addClass("undodislike");
    }

    // undodislike posts
    function undodislike(id){
    $("#post-id-" + id).find(".undodislike").removeClass("likedislikeclass");

        $.ajax({
                url: "{% url 'social:dislike-requests' %}",
                type: "POST",
                data: {
                    'post_id': id,
                    'action': 'dislike',
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                success: function(data){
                    $("#post-id-" + id).find("#dislike-count").text(data.counts);
                },
                error: function(data){
                    console.log(data);
                }
            });
    $("#post-id-" + id).find(".undodislike").attr("onclick", "dislike(" + id + ")");
    $("#post-id-" + id).find(".undodislike").removeClass("undodislike").addClass("dislike");
    }



    $('input[name="close-comment"]').click(function(){
        $(this).parent().parent().fadeOut();
    });


    </script>
  
  </body>
{% endif %}
{% endblock %}